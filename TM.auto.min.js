(async()=>{const e={click:t=>e.qs(t)?e.qs(t).click():null,clickLast:t=>{const n=e.qsaa(t);return!!n.length&&(n[n.length-1].click(),!0)},CommandBarBridge:{getCommands:()=>JSON.parse(window.sessionStorage.getItem("__command_bar_active_commands")),execute:t=>{const n="__command_bar_execute_command_response",o=window.sessionStorage;o.removeItem(n),o.setItem("__command_bar_execute_command",t),e.qs("#__command_bar_bridge_input").click();const a=o.getItem(n);return"true"===a||"false"!==a&&null}},autoLogin:()=>{const t=e.qsaa("input[type=password]").filter((e=>!!e.offsetParent));if(1!==t.length)return;const n=t[0];n.value.length>3&&n?.closest("form")?.querySelector("[type=submit]")?.click()},updateReactTypableFormValue:(e,t)=>{const n={INPUT:"HTMLInputElement",TEXTAREA:"HTMLTextAreaElement",SELECT:"HTMLSelectElement"};if(!(e.tagName in n))return void console.log("unsupported type");Object.getOwnPropertyDescriptor(window[n[e.tagName]].prototype,"value").set.call(e,t);const o=["input"];"SELECT"===e.tagName&&o.push("change"),o.forEach((t=>{const n=new Event(t,{bubbles:!0});e.dispatchEvent(n)}))},Utils:{allLetterCombinations:(e,t=[])=>{if("number"!=typeof e)throw Error("numLetters must be a number");if(e<0)throw Error("numLetters must be greater than or equal to zero");if(0===e)return[];const n="abcdefghijklmnopqrstuvwxyz".split(""),o=e=>n.map((t=>e+t)),a=(e,t=n,s=1)=>e==s?t:a(e,(e=>(e=>e.reduce(((e,t)=>e.concat(t)),[]))(e.map(o)))(t),s+1);return a(e).filter((e=>!t.length||t.includes(e[0])))},findGalleries:()=>e.qsaa("span,div").filter((e=>{const t=Array.from(e.children).filter((e=>e.offsetHeight>0&&e.offsetWidth>0));if(t.length<3)return!1;const n=new Set;return t.map((e=>e.offsetHeight+"x"+e.offsetWidth)).forEach((e=>n.add(e))),Array.from(n).every((e=>e.split("x").map((e=>Number(e))).every((e=>e>100))))})),animateGalleryPreviews:t=>{Array.from(t.children).map((e=>e.querySelector("img"))).filter((e=>!!e)).forEach(e.simulateHover)},getIsElementVisible:e=>e.offsetWidth>0&&e.offsetHeight>0,openTemporaryWindow:e=>{const t=window.open(e);return!t||t.closed||void 0===t.closed?(alert("[noop] couln't open window to send message"),!1):(setTimeout((()=>t.close()),1e4),!0)},addCssLinkIfNeeded:e=>{if(Array.from(document.head.querySelectorAll("link")).map((e=>e.href)).includes(e))return;const t=window.document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=e,document.getElementsByTagName("HEAD")[0].appendChild(t)},toast:(e={})=>{const t={message:"",dismissible:!0,timeout:5e3,actions:[],fixed:!0,position:"br",...e};SnackBar(t)},getMostCommonUnitElements:(e,t)=>{const n={};e.map(t).filter((e=>!!e)).forEach((e=>n[e]=(n[e]||0)+1));const o=Object.keys(n).reduce(((e,t)=>n[e]>n[t]?e:t));return e.filter((e=>t(e)===o))}},qs:e=>document.querySelector(e),qsa:e=>document.querySelectorAll(e),qsaa:t=>e.qsaArray(t),qsaArray:t=>Array.from(e.qsa(t)),lmkr:async e=>{const t="https://sum-notifier.vercel.app/api/v1/notify?message="+encodeURIComponent(e)+"&title=Chrome%20Helper";return await fetch(t,{mode:"no-cors"}),!0},runSteps:async(t,n="",o=1e3)=>{try{for(let n=0;n<t.length;n++)t[n](),await e.sleep(o)}catch(e){n&&alert(n)}},lmkrWhenSelectedElementChanges:()=>{const t=()=>Math.round((new Date).getTime()/1e3),n=t(),o=$0;if(!o)return alert("[noop] select an element using element inspector an try again."),!1;const a=e=>[e.value||"",e.outerHTML||""].join(":"),s=a(o),i=e=>e.length>30?e.substr(0,29)+"â€¦":e,r=(o,s)=>{const c=a(o);if(o&&c===s){const e=t()-n;e%60==0&&console.log("["+Math.round(e/60)+"m] still checking every 500ms..."),setTimeout((()=>r(o,s)),500)}else e.lmkr("Watched element changed:\nðŸ: "+i(c)+"\nðŸ³: "+i(s)),console.log("notified element change")};return e.lmkr("Watching for element changes:\nðŸ³: "+i(s))?(r(o,s),window.MineElement=o,o):(alert("Unable to send messages. Fix that and try again."),!1)},colorElementsByValue:(e,t,n={})=>{const o=(e=e.filter((e=>!isNaN(t(e))))).map(t),a=n.filterOutliers?(e=>{if(e.length<4)return{};let t,n,o,a,s;return t=e.slice().sort(((e,t)=>e-t)),t.length/4%1==0?(n=.5*(t[t.length/4]+t[t.length/4+1]),o=.5*(t[t.length*(3/4)]+t[t.length*(3/4)+1])):(n=t[Math.floor(t.length/4+1)],o=t[Math.ceil(t.length*(3/4)+1)]),a=o-n,s=1.5,{min:n-1.5*a,max:o+1.5*a}})(o):{},s=Math.min(...o),i=(a.max||Math.max(...o))-s;e.forEach((e=>{const o=[255,0,0],a=[0,255,0],r=n.invertColors?o:a,c=n.invertColors?a:o,l=(t(e)-s)/i,d=((e,t,n)=>{const o=(2*(1-e)-1+1)/2,a=1-o;return[parseInt(t[0]*o+n[0]*a),parseInt(t[1]*o+n[1]*a),parseInt(t[2]*o+n[2]*a)]})(l,r,c),p=0===l||l>=1;e.style[p?"border":"borderBottom"]="4px RGB("+d.join(",")+") solid",p&&(e.style.background="RGB("+d.join(",")+")"),p&&(e.style.color="white"),e.style.borderRadius="3px";const m="Relative efficiency: "+Math.round(100*(n.invertColors?l:1-l))+"%\n";e.title=(""+m+e.title).trim()}))},sleep:async(e=1e3)=>new Promise((t=>setTimeout(t,e))),colorColumnByValue:(t,n,o,a={})=>{if(!t)return!1;const s=Array.from(t?.tHead?.children[0]?.children||[]).findIndex((e=>e.innerText.trim().toLowerCase()===n.trim().toLowerCase())),i=Array.from(t.querySelectorAll("tbody tr td:nth-child("+(s+1)+")"));e.colorElementsByValue(i,o,a)},scrollToTop:(e=!1)=>window.scroll({top:0,left:0,behavior:e?"auto":"smooth"}),scrollToBottom:(e=!1)=>window.scroll({top:document.body.scrollHeight,left:0,behavior:e?"auto":"smooth"}),scrollToElement:(e,t=0)=>new Promise((n=>{const o=(window.pageYOffset||document.documentElement.scrollTop)+e.getBoundingClientRect().top-100+t;Math.round(window.scrollY)!==Math.round(o)?(window.scrollTo({top:o,left:0,behavior:"smooth"}),((e=()=>{})=>{const t=(n=null)=>{clearTimeout(n),n=setTimeout((()=>{n=null,removeEventListener("scroll",t),e()}),100)};addEventListener("scroll",t);const n=window.scrollY;setTimeout((()=>{window.scrollY===n&&(removeEventListener("scroll",t),e())}),100)})(n)):n()})),simulateClickWithHint:async t=>{if(!t)return;await e.scrollToElement(t);const n=t.getBoundingClientRect(),o=n.left+window.scrollX,a=n.top+window.scrollY,s=n.width,i=n.height,r="__CommandBarMine_circler__",c=()=>e.qs("#"+r);((e,t)=>{const n=c();n&&n.remove();const o=document.createElement("div");o.id=r,o.style.position="absolute",o.style.border="10px solid slateblue",o.style.borderRadius="20px",o.style.boxShadow="rgba(0, 0, 0, 0.45) 0px 0px 50px",o.style.width=e+30+"px",o.style.height=t+30+"px",o.style.pointerEvents="none",o.style.opacity="0",o.style.transition="opacity 500ms",o.style.zIndex="100000000",document.body.append(o)})(s,i);const l=c(),d=l.offsetWidth;l.style.top=a-(l.offsetHeight-i)/2+"px",l.style.left=o-(d-s)/2+"px",l.style.opacity="1",await e.sleep(500),e.simulateClick(t),await e.sleep(200),l.style.opacity="0",await e.sleep(500)},simulateClick:(e,t=[])=>{if(!e)return;const n=t.includes("left_quarter"),o=e.getBoundingClientRect(),a=o.left+(o.right-o.left)*(n?.2:.5),s=o.top+.5*(o.bottom-o.top);["mousedown","mouseup","click"].forEach((t=>((e,t,n,o)=>{e.dispatchEvent(new MouseEvent(t,{view:window,bubbles:!0,cancelable:!0,clientX:n,clientY:o,button:0}))})(e,t,a,s)))},simulateHover:e=>e.dispatchEvent(new Event("mouseover",{view:window,bubbles:!0,cancelable:!1})),assertTruthy:e=>{if(e)return e;throw"assertion failed"},waitFor:async(t,{timeoutMs:n=5e3,recheckIntervalMs:o=null,shouldPadDelay:a=!1,debugMsg:s=""}={})=>{const i=Date.now();for(;;){const r=await t();if(r)return a&&await e.sleep(25),r;const c=Date.now()-i;if(c>=n)throw new Error("Timeout"+(s.trim()?": "+s.trim():""));if(null==o){const t=c<=500;await e.sleep(t?0:5)}else await e.sleep(Number(o))}},waitForQs:async(t,n={})=>await e.waitFor((()=>e.qs(t)),n),getQueryParam:e=>{const t=window.location.search,n=new URLSearchParams(t);return n.has(e)?n.get(e):null},noop:()=>{},injectStylesheetIdempotent:(t="")=>{const n=t.trim();if(e.qsaa("style").map((e=>e.textContent)).some((e=>e===n)))return e.noop;const o=document.createElement("style");return o.textContent=n,document.head.appendChild(o),()=>o.remove()},injectScriptIdempotent:async t=>new Promise((n=>{if(e.qsaa("script").map((e=>e.src)).some((e=>e===t)))return n();const o=document.createElement("script");o.type="text/javascript",o.async=!0,o.onload=()=>n(),o.src=t,document.getElementsByTagName("head")[0].appendChild(o)})),wrapAddEventListenerWithBlockers:(e=[])=>{Object.getOwnPropertyNames(window).filter((e=>/^HTML/.test(e))).map((e=>window[e])).forEach((t=>{var n;n=t.prototype.addEventListener,t.prototype.addEventListener=function(t,o,a){const s=this;if(!e.some((e=>t===e.type&&s.matches(e.querySelector))))return n.apply(this,arguments)}}))},PepperAgent:class{constructor(e,t=[]){this.name=e,this.commands=t,this.#e(),this.#t()}#e(){this.commands.push({title:"restart",description:"",run:async()=>{window.open("http://reload.extensions"),setTimeout((()=>location.reload()),3e3)}})}async#t(){await e.injectScriptIdempotent("https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.4/socket.io.js"),this.socket=io("https://pepperpotts.fly.dev:443",{query:{name:this.name,commands:this.commands}}),this.socket.on("connect",(()=>{console.log("[Mine] connected to pepper"),this.socket.emit("register-commands",this.commands)})),this.socket.on("disconnect",(e=>{console.log("[Mine] disconnected from pepper"),"io server disconnect"===e&&(console.log("[Mine] trying to reconnect to pepper..."),this.socket.connect())})),this.commands.forEach((({title:e,run:t})=>{this.socket.on(e,(async(e,n)=>{n(await t()||{success:!0})}))})),window.addEventListener("focus",(()=>{this.socket.connected&&this.socket.disconnect(),this.socket.connect()}))}async ask(e,t=[],n=()=>{},o=6e4){const a={questionObj:e,responseOptions:t,timeoutMs:o};this.socket.timeout(o).emit("ask",a,n)}},randomItemFromArray:e=>e[Math.floor(Math.random()*e.length)],setIntervalAndNow:(e,t=1e3)=>{e(),setInterval(e,t)},processUnprocessedItems:(e=[],t,n="")=>{const o="data-mine-processed"+(n?"-"+n:""),a=Array.from(e).filter(Boolean).filter((e=>!("true"===e.getAttribute(o)))),s=e=>e.setAttribute(o,"true");for(let e=0;e<a.length;e++){const n=a[e];t(n),s(n)}},setQueryParam:(e,t)=>{const n=new URL(window.location);n.searchParams.set(e,t),window.location=n.href},dim:e=>{if(!e)return;(e=>{const t=e.style.transition.split(",").map((e=>e.trim())).filter((e=>e.length)).filter((e=>!e.includes("opacity")));t.push("opacity 0.2s ease"),e.style.transition=t.join(", ")})(e);const t="0.05";let n;const o=()=>{n=setTimeout((()=>{e.style.removeProperty("opacity")}),500)},a=()=>{clearTimeout(n),e.style.opacity=t};return e.style.setProperty("opacity",t),e.addEventListener("mouseover",o),e.addEventListener("mouseout",a),()=>{e.style.removeProperty("opacity"),e.removeEventListener("mouseover",o),e.removeEventListener("mouseout",a)}}};window.Mine=e,e.getIndexedDbValue=async(e,t,n)=>new Promise(((o,a)=>{const s=indexedDB.open(t);s.onerror=e=>a("An error occurred while accessing the database: "+e.target.errorCode),s.onsuccess=t=>{const s=t.target.result.transaction([n],"readonly").objectStore(n).get(e);s.onerror=e=>a("An error occurred while retrieving the data: "+e.target.errorCode),s.onsuccess=e=>o(e.target.result)}})),e.addEventListenerForSubtreeAddOrRemove=(e,t)=>{new MutationObserver(((e,n)=>{for(let n of e)"childList"===n.type&&t()})).observe(e,{childList:!0,subtree:!0})},e.onElementRemoval=(e,t)=>{new MutationObserver(((n,o)=>{!e.isConnected&&(o.disconnect(),t())})).observe(document,{childList:!0,subtree:!0})},e.onElementRemove=e.onElementRemoval,e.colorizeByContent=(t=[],n=e=>e.innerText,o="content")=>e.processUnprocessedItems(t,(t=>{const o=n(t),a=e.getHashedStringToHex(o);!t.style.transition&&(t.style.transition="color 0.1s"),t.style.setProperty("color",a,"important")}),o+"-colorizer"),e.sessionCacheManageFn=e=>async(...t)=>{const n="mine.cached."+encodeURIComponent(JSON.stringify(t)),o=window.sessionStorage.getItem(n);if(o)return JSON.parse(o);const a=await e(...t);return window.sessionStorage.setItem(n,JSON.stringify(a)),a},e.isi=e.injectStylesheetIdempotent,e.withSimpleCache=e=>{const t=new Map;return(...n)=>{const o=JSON.stringify(n);if(t.has(o))return t.get(o);const a=e(...n);return t.set(o,a),a}};const t=e.withSimpleCache((e=>{if("string"!=typeof e)throw new Error("Color input must be a string");const t=e=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},n={black:"#000000",white:"#ffffff",red:"#ff0000",lime:"#00ff00",blue:"#0000ff",yellow:"#ffff00",cyan:"#00ffff",magenta:"#ff00ff",silver:"#c0c0c0",gray:"#808080",maroon:"#800000",olive:"#808000",green:"#008000",purple:"#800080",teal:"#008080",navy:"#000080"};if(e.startsWith("#"))return t(e);if(e.toLowerCase().startsWith("rgb("))return(e=>{const t=/rgb\((\d+),\s*(\d+),\s*(\d+)\)/i.exec(e);return t?{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}:null})(e.toLowerCase());if(e.toLowerCase()in n)return(e=>{const o=n[e.toLowerCase()];return o?t(o):null})(e);if(e.toLowerCase().startsWith("rgba("))return(e=>{const t=/rgba\((\d+),\s*(\d+),\s*(\d+),\s*[\d.]+\)/i.exec(e);return t?{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}:null})(e.toLowerCase());throw new Error("Invalid color format provided: "+e+". Accepts hex string, RGB string, or named HTML color.")})),n=e=>{const t=[e.r,e.g,e.b].map((e=>e/255)).map((e=>e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)));return.2126*t[0]+.7152*t[1]+.0722*t[2]},o=e=>{let t=0;for(let n=0;n<e.length;n++)t=Math.imul(31,t)+e.charCodeAt(n)|0;let n="#";for(let e=0;e<3;e++)n+=(t>>8*e&255).toString(16).padStart(2,"0");return n};e.getHashedStringToHex=e.withSimpleCache(((e,a)=>{let s=o(e);if(a){const i=4.5;let r=0;const c=10,l=t(a);let d=0,p=s;const m=e=>{const o=((e,t)=>{const o=n(e),a=n(t);return(Math.max(o,a)+.05)/(Math.min(o,a)+.05)})(t(e),l);return o>d&&(d=o,p=e),o};let u=m(s);for(;u<i&&r<c;)r++,s=o(e+r),u=m(s);s=p}return s})),e.getCssToHide=e=>"\n"+e+" {\n  display: none !important;\n}\n",e.getCssToQuietQs=(e,{delayMs:t=1e3}={})=>("\n"+e+" {\n  opacity: 0.2;\n  transition: opacity 0.2s ease-in-out !important;\n}\n"+e+":hover {\n  transition-delay: "+t/1e3+"s !important;\n  opacity: 1;\n}\n").trim(),e.bindHotkey=(e,t=document,n)=>{const o=e.split("+").map((e=>e.trim().toLowerCase()));let a="";const s={shiftKey:!1,ctrlKey:!1,altKey:!1,metaKey:!1};o.forEach((e=>{const t=Object.keys(s).find((t=>t.toLowerCase()===e));t?s[t]=!0:a=e})),t.addEventListener("keydown",(e=>{const o=t!==document||!["input","textarea","select","button"].includes(e.target.tagName.toLowerCase())&&!e.target.isContentEditable,i=e.key.toLowerCase()===a;Object.keys(s).every((t=>s[t]===e[t]))&&i&&o&&n(e)}))},e.Ai={getResponseText:async(e,t="You are a helpful AI.")=>{const n=[];n.push({role:"system",content:t}),n.push({role:"user",content:e});const o={model:"gpt-4-1106-preview",messages:n};return(await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer sk-"},body:JSON.stringify(o)}).then((e=>e.json()))).choices[0].message.content}},e.spotlightElement=t=>{let n=t.getBoundingClientRect();const o=t=>{e.qsaa(".mine-wall").forEach((e=>{e.style.opacity="0",setTimeout((()=>e.remove()),500)})),t?.disconnect()},a=new MutationObserver((e=>{e.forEach((e=>{if("style"===e.attributeName){const e=t.getBoundingClientRect();(e.left!==n.left||e.top!==n.top)&&o(a)}else"childList"===e.type&&!document.body.contains(t)&&o(a)}))}));a.observe(t,{attributes:!0,attributeFilter:["style"],childList:!0,subtree:!0});const s=document.createElement("div");s.classList.add("mine-wall"),s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.width="100%",s.style.height="100%",s.style.background="rgba(0, 0, 0, 0.9)",s.style.zIndex="10000",s.style.opacity="0",s.style.transition="opacity 200ms",s.addEventListener("click",(()=>o(a))),setTimeout((()=>s.style.opacity="1"),10);const i=n.top,r=(window,window,n.left);s.style.clipPath="polygon(\n      0px 0px,\n      100% 0px,\n      100% "+i+"px,\n      "+r+"px "+i+"px,\n      "+r+"px "+n.bottom+"px,\n      "+n.right+"px "+n.bottom+"px,\n      "+n.right+"px "+i+"px,\n      100% "+i+"px,\n      100% 100%,\n      0px 100%\n    )",document.body.append(s)},e.pui=e.processUnprocessedItems,e.processUnprocessedItemsContinually=async(t,n,o="")=>{!o&&(o=Date.now().toString());const a=()=>{e.pui(t(),n,o),setTimeout(a,1e3)};a()},e.puic=e.processUnprocessedItemsContinually,e.hideQs=t=>e.isi(e.getCssToHide(t)),e.quietQs=t=>e.isi(e.getCssToQuietQs(t)),e.removeElement=async e=>new Promise((t=>{if(!e)return void t();const n=window.getComputedStyle(e),o=n.height;e.style.width=n.width,e.style.height=o,requestAnimationFrame((()=>{e.style.transition="opacity 150ms, width 150ms, height 150ms",e.style.opacity="0",e.style.width="0",e.style.height="0",e.style.overflow="hidden",e.addEventListener("transitionend",(function n(o){"opacity"===o.propertyName&&(e.removeEventListener("transitionend",n),e.remove(),t())}))}))})),e.removeEle=e.removeElement,e.collapse=(e,t="100px")=>{if(!e)return;const n=document.createElement("div");n.style="position: relative; overflow: hidden; max-height: "+t+"; transition: max-height 0.3s ease;";const o=document.createElement("div");o.title="Expand collapsed item",o.style="position: absolute; bottom: 0; left: 0; right: 0; height: 100%; background: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.2)); cursor: pointer; border-radius: 5px;",o.addEventListener("click",(()=>{const e=n.style.maxHeight===t;n.style.maxHeight=e?"none":t,o.style.display=e?"none":"block"})),e.parentNode.insertBefore(n,e),n.appendChild(e),n.appendChild(o);const a=new MutationObserver((e=>{e.forEach((e=>{if("childList"===e.type){for(o.remove();n.firstChild;)n.parentNode.insertBefore(n.firstChild,n);n.parentNode.removeChild(n),a.disconnect()}}))}));a.observe(n,{childList:!0})},e.attachToElementContinuously=async(t=()=>{},n=()=>{},o={})=>{const a=async()=>{const s=await t().catch((()=>null));s?(await n(s),e.onElementRemoval(s,(async()=>{o.onElementGone&&await o.onElementGone(),a()}))):o.onElementNotFound&&await o.onElementNotFound()};await a()},e.debounce=(e,t=1e3,n=null)=>(...o)=>(clearTimeout(n),n=setTimeout((()=>e(...o)),t));const a=async t=>await e.getIndexedDbValue(`CHAT_${t}`,"keyval-store","keyval"),s=()=>e.qsaa("button").find((e=>"Stop"===e.innerText)),i=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),r=(e,t)=>e.split("\n").filter((e=>!!e.trim())).map(t).join("\n"),c=()=>e.qsaa('[data-element-id="ai-response"], [data-element-id="user-message"]'),l=async()=>await e.waitForQs("#chat-input-textbox"),d=async e=>{if(!e)return null;const t="keyval";return new Promise(((n,o)=>{const a=indexedDB.open("keyval-store");a.onerror=e=>o(`IndexedDB error: ${e.target.error}`),a.onsuccess=a=>{const s=a.target.result.transaction([t],"readonly").objectStore(t).openCursor();s.onerror=e=>o(`Cursor error: ${e.target.error}`),s.onsuccess=t=>{const o=t.target.result;if(o){const t=o.value;if(o.key.startsWith("CHAT_")&&Array.isArray(t.messages)){const o=t.messages.find((t=>"user"===t.role&&"string"==typeof t.content&&t.content.trim().match(new RegExp(`^${e}=.+$`))));if(o){const e=o.content.trim().split("=")[1];return void n(e)}}o.continue()}else n(null)}}}))},p=new Map,m=(e,t)=>{p.size>0||document.body.addEventListener(i?"touchend":"click",(async e=>{for(const[t,n]of p){const o=e.target.closest(t);o&&n.forEach((e=>e(o)))}})),p.has(e)||p.set(e,new Set),p.get(e).add(t)},u=window.scrollTo;let h=!0;window.scrollTo=(...e)=>{if(!h)return;const t=e[0],n="object"==typeof t?t:{top:t,left:e[1]};n.behavior="smooth",u.call(window,n)};const y=()=>h=!0;e.quietQs('[data-element-id="pinned-characters-container"]'),e.isi('\n/* context limit reached button is in here */\n.post-message-content {\n  display: none;\n}\n\n[id="elements-in-action-buttons"] button {\n  scale: 0.8;\n}\n[id="elements-in-action-buttons"] {\n  gap: 0.1rem;\n  margin-bottom: 0;\n}\n\n[data-element-id="chat-avatar-container"] {\n  display: none;\n}\n[data-element-id="response-block"] {\n  padding-left: 0.5rem;\n}\n\n@media (max-width: 767px) {\n  /* cant use message-index- bc thats doesnt covery typing state */\n  div:has(>[data-element-id="response-block"]) {\n    padding-right: 9px;\n    padding-left: 9px;\n  }\n  [data-element-id="current-chat-title"] > :first-child {\n    gap: 0;\n  }\n  [data-element-id="response-block"] {\n    padding-left: 0;\n  }\n\n  /* model name snippet */\n  [data-element-id="current-chat-title"] [aria-haspopup="menu"] .truncate {\n    display: none;\n  }\n\n  [data-element-id="search-shortcut-button"] {\n    display: none;\n  }\n  [id="chat-input-textbox"] {\n    padding-left: 10px;\n  }\n\n  .enter-to-send {display: none;}\n  [data-element-id="chat-space-end-part"] {padding:4px;}\n  [data-element-id="message-input"] {margin-top: -20px;}\n  [data-element-id="prompt-library-small-button"] {display: none;}\n  [data-element-id="output-settings-button"] {display: none;}\n  #chat-input-textbox {padding: 7px;}\n  [data-element-id="chat-input-textbox-container"] button {opacity: 0.7;}\n  [data-element-id="response-block"] {padding:0;padding-top:10px;}\n}\n\ndiv:has(> div > img[src="/logo.png"]) {\n  display: none;\n}\n.prose {\n  background: rgb(39, 39, 42);\n  border-radius: 16px;\n  padding: 10px;\n  color: white;\n}\n/* my avatar */\n[data-element-id="response-block"]:has([data-element-id="user-message"]) [data-element-id="chat-avatar-container"] {\n  display: none;\n}\n\ndiv:has(>.bg-blue-500) {\n  display: flex;\n  justify-content: flex-end;\n}\ndiv > button:has(.user-avatar) {\n  visibility: hidden;\n}\n\nbody {\n  background: rgb(16,17,17) !important;\n}\n.response-block:hover {\n  background: none !important;\n}\n\n/* might need to separate these two */\n.response-block li,\n.response-block p\n{\n  border-radius: 5px;\n  margin: 2px;\n  padding-left: 2px;\n  padding-right: 2px;\n}\n\n.response-block li, .response-block li *\n.response-block p, .response-block p *\n{\n  color: white;\n  transition: color 0.1s ease-in-out;\n}\n.response-block li:hover, .response-block li:hover *,\n.response-block p:hover, .response-block p:hover *\n{\n  color: hotpink;\n  transition: color 0s;\n}\n\n.response-block li ul {\n  margin-top: 0;\n}\n.response-block li:nth-child(even), .response-block p:nth-child(even) {\n  background-color: RGBA(0,0,0,0.3);\n}\n\n[data-element-id="list-more-button"] {\n  display: none;\n}\n');const g=async()=>{const t=async()=>{const e=window.location.hash.split("chat=")[1];return e?(await a(e)).chatParams.contextLimit:null},n=()=>e.qsaa('[data-element-id="response-block"]'),o=async()=>{const o=window.location.hash.split("chat=")[1];o&&await a(o)&&(await(async()=>{const o=e.qsaa('[data-element-id="current-chat-title"] button').reverse()[0];if(!o)return;const a="__mine_info_div",s=()=>e.qs(`#${a}`),i=s();if(!i){const e=document.createElement("div");e.id=a,e.style.opacity="0",e.style.transition="opacity 0.2s",o.parentNode.insertBefore(e,o),e.style.opacity="1"}const r=i||s(),c=n();let l=c.length;const d=e.qsaa('[data-element-id="clear-context-divider"]').pop(),p=(e,t)=>t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_PRECEDING;if(d&&c.length){const e=c.slice(-1)[0];l=p(e,d)?0:l-c.findIndex((e=>p(d,e)))+1}let m=await t();0===m&&(m=1/0),r.innerHTML=`${l}/<span style='${l>=m?"color:red;":""};'>${m===1/0?"âˆž":m} mc</span>`})(),await(async()=>{if(s())return;e.qsaa(".firstLookbackMessage.visible").forEach((e=>{e.classList.remove("firstLookbackMessage"),e.classList.remove("visible")}));const o=n().reverse(),a=Number(await t());if(a<=o.length){const e=o[a-1],t=e?.closest('[data-element-id="response-block"]').parentElement;t&&(t.classList.add("firstLookbackMessage"),t.classList.add("visible"))}})())};e.attachToElementContinuously((async()=>await e.waitForQs('[data-element-id="chat-space-middle-part"]',{recheckIntervalMs:500,timeoutMs:1/0})),(t=>{o(),e.addEventListenerForSubtreeAddOrRemove(t,o)}))};g(),setTimeout((()=>{c()}),1e3),(async()=>{const e={SEARCH:async({queries:e,lookbackDays:n})=>{for(let o=0;o<e.length;o++){const a=e[o],s=await t(a,n);if(s.length)return s}return[]}},t=async(e,t)=>{const n="keyval",o=[],a=new Date;return a.setDate(a.getDate()-t),new Promise(((t,s)=>{const i=indexedDB.open("keyval-store");i.onerror=e=>s(`IndexedDB error: ${e.target.error}`),i.onsuccess=i=>{const r=i.target.result.transaction([n],"readonly").objectStore(n).openCursor();r.onerror=e=>s(`Cursor error: ${e.target.error}`),r.onsuccess=n=>{const s=n.target.result;if(s){const t=s.value;if(s.key.startsWith("CHAT_")&&Array.isArray(t.messages)){const n=new RegExp(`\\b${e}\\b`,"i"),s=t.messages.filter((e=>"user"===e.role&&n.test(e.content)&&new Date(e.createdAt)>=a));if(n.test(t.chatTitle)){const e=t.messages.find((e=>"user"===e.role));e&&new Date(e.createdAt)>=a&&!s.some((t=>t.createdAt===e.createdAt))&&s.push(e)}const i=s.map((e=>({content:e.content,createdAt:e.createdAt}))).filter((e=>{const t=(new Date).toUTCString(),n=e.createdAt,o=new Date(t),a=new Date(n),s=o.getTime()-a.getTime(),i=Math.round(s/1e3);return!Math.abs(i<10)}));o.push(...i)}s.continue()}else t(o)}}}))},n=await d("memoryPluginPassword"),o=(()=>{const e=new Uint8Array([99,114,121,112,116,111,115,97,108,116,49,50,51,52,53,54]),t=n;async function o(t){const n=(new TextEncoder).encode(t),o=await window.crypto.subtle.importKey("raw",n,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]);return window.crypto.subtle.deriveKey({name:"PBKDF2",salt:e,iterations:1e5,hash:"SHA-256"},o,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}return{encrypt:async function(e){const n=await o(t),a=(new TextEncoder).encode(JSON.stringify(e)),s=window.crypto.getRandomValues(new Uint8Array(12)),i=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:s},n,a);return{iv:Array.from(s),data:Array.from(new Uint8Array(i))}},decrypt:async function(e){const n=await o(t),a=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(e.iv)},n,new Uint8Array(e.data));return JSON.parse((new TextDecoder).decode(a))}}})();window.addEventListener("message",(async t=>{const{encryptedData:a}=t.data;if(a)try{const s=await o.decrypt(a),{id:i,func:r,request:c}=s,l=async()=>{const e=await o.encrypt({id:i,error:"Function not found"});t.source.postMessage({encryptedError:e},"*")};if(!n)return alert('memory plugin password not found. start a new chat and send a message "memoryPluginPassword=<the-password-no-quotes>" with no quotes'),void await l();if("function"==typeof e[r]){const n=await e[r](c),a=await o.encrypt({id:i,result:n});t.source.postMessage({encryptedResult:a},"*")}else await l()}catch(e){console.error("Decryption error:",e)}}))})(),setTimeout((async()=>{const t=t=>async({selectedText:n,isLongPressed:o})=>{const a=(s=t,`${r(n.trim(),(e=>`> ${e}`))}\n${s}`);var s;return await(async(t,n)=>{const o=await l();return e.updateReactTypableFormValue(o,o.value?`${o.value}\n\n${t}`:t),e.qs('button:has([d="M12 7.59 7.05 2.64 5.64 4.05 12 10.41l6.36-6.36-1.41-1.41L12 7.59zM5.64 19.95l1.41 1.41L12 16.41l4.95 4.95 1.41-1.41L12 13.59l-6.36 6.36z"])')?.click(),o.blur(),o.scrollTo({top:o.scrollHeight,behavior:"smooth"}),n&&(await(async()=>await e.waitForQs('[data-element-id="send-button"]'))()).click(),!0})(a,o)},n={elab:t("elaborate"),"?":t("?"),"ðŸ‘ðŸ»":t("ðŸ‘ðŸ»"),"ðŸ‘ŽðŸ»":t("ðŸ‘ŽðŸ»"),"ðŸ©¶":t("ðŸ©¶"),"â€œâ€":async({selectedText:e,isLongPressed:n})=>{const o=prompt(`> ${e}`);if(!o)return!1;const a=t(o);return await a({selectedText:e,isLongPressed:n})}},o=document.createElement("div");o.id="custom-popover",o.className="custom-popover",o.innerHTML=Object.keys(n).map((e=>`<button class="popover-button">${e}</button>`)).join(""),document.body.appendChild(o);const a=document.createElement("style");a.textContent="\n:root {\n  --popover-bg: #333;\n  --popover-text: #fff;\n  --popover-active: #555;\n  --popover-border: #444;\n}\n\n.custom-popover {\n  display: none;\n  position: fixed;\n  background-color: var(--popover-bg);\n  border-radius: 6px;\n  box-shadow: 0 8px 19px rgba(0,0,0,0.6);\n  padding: 2px;\n  z-index: 1000;\n  border: 1px solid var(--popover-border);\n  opacity: 0;\n  transition: opacity 0.1s ease-in-out;\n}\n\n.custom-popover::before {\n  content: '';\n  position: absolute;\n  top: -8px;\n  left: 50%;\n  transform: translateX(-50%);\n  border-left: 8px solid transparent;\n  border-right: 8px solid transparent;\n  border-bottom: 8px solid var(--popover-bg);\n  z-index: 1001;\n}\n\n.custom-popover::after {\n  content: '';\n  position: absolute;\n  top: -9px;\n  left: 50%;\n  transform: translateX(-50%);\n  border-left: 9px solid transparent;\n  border-right: 9px solid transparent;\n  border-bottom: 9px solid var(--popover-border);\n  z-index: 1000;\n}\n\n.custom-popover.show {\n  opacity: 1;\n}\n\n.popover-button {\n  background-color: transparent;\n  border: none;\n  color: var(--popover-text);\n  font-size: 14px;\n  padding: 6px 8px;\n  margin: 0 2px;\n  cursor: pointer;\n  transition: background-color 0.1s;\n  border-radius: 6px;\n}\n\n.popover-button:active {\n  background-color: var(--popover-active);\n}\n    ".trim(),document.head.appendChild(a);let s=null,i=!1;const c=()=>{i&&(o.classList.remove("show"),setTimeout((()=>{o.style.display="none",s=null,i=!1}),100))},d=()=>{const e=window.getSelection();if(e.toString().length>0&&!i){s=e.toString();const t=e.getRangeAt(0),n=t.getBoundingClientRect();if(!(t.commonAncestorContainer.nodeType===Node.TEXT_NODE?t.commonAncestorContainer.parentElement:t.commonAncestorContainer).closest('[data-element-id="response-block"]'))return;o.style.display="flex",o.classList.remove("show"),i=!0,(e=>{const t=window.innerWidth,n=window.innerHeight;setTimeout((()=>{o.style.visibility="hidden",o.style.display="flex";const a=o.getBoundingClientRect();let s=e.left+(e.width-a.width)/2,i=e.bottom+10;(i<=0||i>=n)&&(i=n/2);const r=()=>{s+a.width>t&&(s=t-a.width-10),s<10&&(s=10),i+a.height>n&&(i=e.top-a.height-10),i<10&&(i=10),i+=10,o.style.left=`${s}px`,o.style.top=`${i}px`;const c=o.getBoundingClientRect();(c.right>t||c.bottom>n)&&r()};r(),o.style.visibility="visible",o.classList.add("show")}),50)})(n)}else 0!==e.toString().length||o.contains(document.activeElement)||c()};document.addEventListener("mouseup",d),document.addEventListener("touchend",d),document.addEventListener("mousedown",(e=>!o.contains(e.target)&&c())),document.addEventListener("scroll",(e=>!o.contains(e.target)&&c())),document.addEventListener("touchstart",(e=>!o.contains(e.target)&&c())),o.addEventListener("touchstart",(e=>e.preventDefault())),o.querySelectorAll(".popover-button").forEach((e=>{let t=!1;const o=async t=>{const o=e.textContent.toLowerCase(),a=s;let i=!1;n[o]&&(i=await n[o]({selectedText:a,isLongPressed:t})),i&&c()},a=((e,t=500)=>{let n,o=!1;return{start:a=>{o=!1,n=setTimeout((()=>{o=!0,e(!0)}),t)},cancel:()=>{clearTimeout(n)},isLongPressDetected:()=>o}})((()=>o(!0))),i=async e=>{e.preventDefault(),e.stopPropagation(),"touchend"===e.type&&(t=!0),"click"===e.type&&t||(a.cancel(),a.isLongPressDetected()||await o(!1))};e.addEventListener("touchstart",(e=>{e.preventDefault(),a.start(e)})),e.addEventListener("touchend",i),e.addEventListener("touchcancel",a.cancel),e.addEventListener("mousedown",a.start),e.addEventListener("click",i),e.addEventListener("mouseleave",a.cancel)}))}),1e3),(async()=>{e.attachToElementContinuously((async()=>await e.waitFor((()=>e.qs('[data-element-id="current-chat-title"] button[id^="headlessui-menu-button-:"][aria-haspopup="menu"]:has(.text-blue-500)')?.parentElement),{recheckIntervalMs:500,timeoutMs:1/0})),(t=>{e.addEventListenerForSubtreeAddOrRemove(t,(async()=>{const e=["Web Search","Perplexity Search","DALL-E 3","Simple Calculator","Stable Diffusion v2 Image","Stable Diffusion v3 Image","Image Search","Web Page Reader","Market News","Azure AI Search","Render Chart","Render HTML"].map((e=>e.toLowerCase()));[...t.querySelectorAll('[role="menuitem"]')].filter((t=>e.includes(t.innerText.toLowerCase().split("\n").pop()))).forEach((e=>e.style.display="none"))}))}))})(),i||(e.isi('\n    [data-element-id="message-input"] .pt-2 {\n      padding-top: 0;\n    }\n    [data-element-id="chat-space-end-part"] {\n      padding-bottom: 5px;\n    }\n'),e.quietQs('a[href="https://custom.typingmind.com"]'),e.isi('form[action="https://codepen.io/pen/define"] {display: none !important;}'),e.isi('[data-element-id="response-block"] div:has(>audio):has(button), [data-element-id="response-block"] div:has(>[data-element-id="in-message-play-button"]) {display: none;}'),e.isi('\n    [data-element-id="ai-characters-system-instruction-input"] {\n      height: 300px;\n    }\n\n\n    /* voice recognition dialog */\n    [data-element-id="pop-up-modal"]:has(option[value="en-AU"]) {\n      right: 10px;\n      top: 100px;\n      position: absolute;\n      zoom: 0.7;\n    }\n\n    .enter-to-send {\n      display: none;\n    }\n\n    [data-headlessui-state] button {\n      border-radius: 10px;\n    }\n\n    .firstLookbackMessage:before {\n      margin-bottom: 10px;\n      content: "â€”â€”â€” context lookback starts â€”â€”â€”";\n      opacity: 0;\n      display: block;\n      text-align: center;\n      color: gray;\n      font-style: italic;\n      transition: opacity 0.25s ease-in-out;\n    }\n    .firstLookbackMessage.visible:before {\n      opacity: 0.5;\n    }\n\n\n    /* pretty tables */\n    table {\n      padding: 2px;\n    }\n    thead th:first-child {\n      border-top-left-radius: 10px;\n    }\n    thead th:last-child {\n      border-top-right-radius: 10px;\n    }\n    table thead {\n      background-color: rgba(0, 0, 0, 0.2);\n    }\n    table tr td:first-child {\n      background-color: rgba(0, 0, 0, 0.2);\n    }\n\n    table tr:hover {\n      background-color: rgba(0, 0, 0, 0.4) !important;\n    }\n    table tr:nth-child(even) {\n      background-color: rgba(0, 0, 0, 0.1);\n    }\n    table tr th:first-child,\n    table tr td:first-child {\n      padding: 10px;\n    }\n    ')),e.isi(".transition {transition-duration: 0s !important;}");const b=async()=>{v()&&(document.body.clientWidth>1e3?(await w()).click():e.qs('button:has([d="M6 18L18 6M6 6l12 12"])').click())},w=async()=>await e.waitFor((()=>e.qsaa("button").find((e=>"Open sidebar"===e.innerText)))),f=async()=>{const t=await l(),n=t.value;n&&e.updateReactTypableFormValue(t,""),await(async()=>{const t=await e.waitFor(s);t&&(t.click(),await e.sleep(100))})(),n&&e.updateReactTypableFormValue(t,n),await e.sleep(100)},v=()=>0===e.qs("#navbar")?.getBoundingClientRect().left,x=async()=>{const t="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z",n=`\n      ${e.getCssToHide('[data-element-id="input-row"] div:has([data-element-id="prompt-library-small-button"])')}\n      ${e.getCssToQuietQs('[data-element-id="current-chat-title"]',{delayMs:0})}\n\n      textarea[data-element-id="new-system-instruction"],\n      textarea[placeholder*="Function Spec"],\n      textarea[placeholder*="JS code"]\n      {\n        font-family: Courier New;\n        height: 400px;\n      }\n\n      .pb-safe:focus {\n        outline: none;\n      }\n\n      .fixed:has([data-element-id="chat-space-end-part"]) {\n        filter: drop-shadow(0px -5px 10px #000000);\n      }\n\n      [data-element-id="send-button"] {\n        display: none;\n      }\n      [data-element-id="main-page-buttons-containter"] button {\n        opacity: 0.2;\n        transition: opacity 0.2s !important;\n      }\n      [data-element-id="main-page-buttons-containter"] button:hover {\n        opacity: 1;\n      }\n\n      [data-element-id="message-input"] label:has(input[type=checkbox]) {\n        display: none;\n      }\n      [id="elements-in-action-buttons"] {\n        display: none;\n      }\n\n      [data-element-id="user-message"] {\n        max-height: 502px;\n      }\n\n      [data-element-id="config-buttons"] {\n        display: none;\n      }\n      [data-element-id="response-block"]:has([data-element-id="model-setting-info"]) {\n        border: 1px solid rgba(255,255,255,0.3);\n        opacity: 0.25;\n        margin-bottom: 25px;\n      }\n\n      [data-element-id="width-adjust-bar"] {\n        display: none;\n      }\n\n\n      /* typing animation */\n      [data-element-id="response-block"]:not(:has([d="${t}"])) div[data-element-id="ai-response"] p:last-of-type:after {\n        animation: blink 1s steps(5,start) infinite;\n        content: "â–‹";\n        vertical-align: baseline;\n      }\n      @keyframes blink {\n        0% {opacity: 1}\n        50% {opacity: 0}\n        to {opacity: 1}\n      }\n\n      /* typing message */\n      [data-element-id="response-block"] + div {\n        /* display: none; */\n      }\n      div.text-gray-500:has(>svg.animate-spin) {\n      /*  display: none; */\n      }\n\n\n      /* context limit reached buton */\n      [data-element-id="chat-space-middle-part"] .text-right button {\n        display: none;\n      }\n\n      /* fix janky where it bounces down after responding. */\n      /* fixed with my scroll override changes i think */\n      /*[data-element-id="response-block"]:has([data-element-id="edit-message-button"]) {\n        margin-bottom: 25px;\n      }\n      */\n\n      [data-element-id="chat-space-middle-part"] {\n        padding-bottom: 126px !important;  /* when resuming a chat, it jumps bc it gets a wierdly tall margin */\n      }\n\n      /* stop button */\n      [data-element-id="chat-space-background"] button:has([d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48z"]) {\n        display: none;\n      }\n\n      .sticky div:has(>a[href^="https://blog.typingmind.com/"]) {\n        visibility: hidden;\n      }\n      button:has([d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"]):focus {\n        outline: none;\n      }\n      #nav-buy-button {\n        display: none;\n      }\n      #chat-input-textbox {\n        padding-left: 12px;\n        background: rgba(0, 0, 0, 0.2);\n      }\n      #chat-input-textbox + button {\n        display: none;\n      }\n      div:has(>button [d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z"]) {\n        display: none;\n      }\n      .transition-all {\n        transition-property: none !important;\n      }\n\n      .user-avatar {\n        background: black;\n      }\n\n      div:has(>.pb-safe) {\n        border: 1px solid dimgray;\n        border-bottom-width: 0;\n        border-top-left-radius: 10px;\n        border-top-right-radius: 10px;\n        opacity: 1;\n        transition: opacity 0.2s;\n      }\n      div:has(>.pb-safe):focus-within,\n      div:has(>.pb-safe):hover{\n        opacity: 1;\n      }\n\n      button[data-element-id="output-settings-button"] {\n        display: none;\n      }\n    `.trim();i||(async()=>{e.isi(n)})().then();const o=e=>!(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey);i||setTimeout((async()=>{const t=window.scrollTo;window.scrollTo=(...e)=>{const n=e[0],o="object"==typeof n?n:{top:n,left:e[1]};o.behavior="smooth",t.call(window,o)},document.addEventListener("keyup",(async t=>{if(!o(t)||"body"!==t.target.tagName.toLowerCase())return;const n=e=>{const t=c();let n=t.findIndex((e=>{const t=e.getBoundingClientRect();return t.top>=0&&t.top<window.innerHeight}));-1===n&&(n=0),n="up"===e?(n-1+t.length)%t.length:(n+1)%t.length,t[n]?.scrollIntoView({behavior:"smooth"})},a={k:()=>n("up"),j:()=>n("down"),l:()=>c().pop()?.scrollIntoView({behavior:"smooth"}),q:async()=>{const t=document.getSelection()?.toString();if(!t)return;const n=r(t.trim(),(e=>`> ${e}`));await(async t=>{const n=await l(),o=`${n.value.trimEnd()}\n\n${t}\n`.trim()+"\n";e.updateReactTypableFormValue(n,o),n.focus(),n.setSelectionRange(n.value.length,n.value.length)})(n)}};t.key in a&&await a[t.key]()}))}),500),(async()=>{const t=async()=>{const t=await l(),n=t.value,o=(e=>{const t=e.match(/ -([a-zA-Z0-9]+)$/);return t?t[1]:null})(n);if(o){const a=(e,t)=>e.endsWith(t)?e.slice(0,-t.length):e;let s=[];const i={q:async()=>s.push("respond as concisely as possible"),n:async()=>s.push("respond normally"),v:async()=>s.push("elaborate")};for(let e=0;e<o.length;e++){const t=o[e];t in i&&await i[t]()}const r=s.length?"\n\nNote: "+s.join(". "):"",c=a(n," -"+o)+r;e.updateReactTypableFormValue(t,c)}e.qs('[data-element-id="send-button"]').click()};i?await e.attachToElementContinuously((async()=>await e.waitForQs('[data-element-id="send-button"]',{recheckIntervalMs:1e3,timeoutMs:1/0})),(async e=>{e.addEventListener("touchend",(async()=>{await t(),(await l()).blur()}))})):await e.attachToElementContinuously(l,(n=>{n.addEventListener("keydown",(async n=>{if(o(n))return"Escape"===n.key?await f():void("Enter"===n.key&&(e.qs('[data-element-id="response-block"]:not(:has([id^="message-timestamp-"]))')&&await f(),await t()))}))}))})();const a=[];(async()=>{if(!a.length){const e=history.pushState,t=history.replaceState,n=()=>a.forEach((e=>e()));history.pushState=function(){e.apply(this,arguments),n()},history.replaceState=function(){t.apply(this,arguments),n()},window.addEventListener("popstate",n)}a.push((()=>setTimeout(C,1e3)))})(),(()=>{const e=["TypingMind.com","TypingMind"];let t=document.title;const n=t=>{let n=e.reduce(((e,t)=>{const n=new RegExp("( - )?"+t,"gi");return e.replace(n,"")}),t);return n=n.split(" â€” The #1 chat frontend UI")[0],n.trim()||(n="TM"),n};Object.defineProperty(document,"title",{get:function(){return t},set:function(e){const o=n(e);t=o,document.querySelector("title").textContent=o},configurable:!0}),document.title=n(t)})(),e.isi("\n      .fade-color-transition {\n        transition: color 0.2s ease-in-out;\n      }\n      pre:has(>code) {\n        border: 1px solid RGBA(100,100,100,1);\n      }\n      code {\n        border-color: RGBA(100,100,100,1) !important;\n      }\n    ");const s=e=>{const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)};e.setIntervalAndNow((async()=>{e.processUnprocessedItems(e.qsaa("code.inline"),(t=>{t.classList.add("fade-color-transition"),t.style.color=t.innerText?.includes(" ")?"gray":e.getHashedStringToHex(t.innerText,getComputedStyle(t).backgroundColor),t.addEventListener("click",(()=>s(t)))}),"code"),e.processUnprocessedItems(e.qsaa('[data-element-id="ai-response"] li'),(e=>e.addEventListener("click",(t=>{t.offsetX>=0||s(e)}))),"list"),e.processUnprocessedItems(e.qsaa('[data-element-id="ai-response"] strong'),(e=>e.addEventListener("click",(t=>s(e)))),"bolded"),e.processUnprocessedItems(e.qsaa('[data-element-id="user-message"] img, [data-element-id="ai-response"] img'),(e=>{e.addEventListener("click",(()=>{const t=e.getAttribute("src");t.startsWith("http")?window.open(t):(t.substring(5,t.indexOf(";")),fetch(t).then((e=>e.blob())).then((e=>{const t=URL.createObjectURL(e);window.open(t,"_blank")})).catch((e=>console.error("Error opening image:",e))))})),e.style.cursor="pointer"}),"img")}),1e3),g(),document.body.clientWidth<1e3&&await b();const[d,p]=window.location.hash.slice(1).split("=");if("mine_char"===d&&p){const[t,n]=p.split(",");(await e.waitFor((()=>e.qsaa("div:has(>button)").find((e=>e.innerText.toLowerCase()===t.toLowerCase()))))).click(),"q"!==n&&(await e.sleep(1e3),t.startsWith("Pepper")&&e.CommandBarBridge.execute("ðŸŽ§ Call-in"))}(async()=>{new class{constructor(e,t){this.activatedCb=e,this.inactivatedCb=t,this.init()}init(){document.addEventListener("keydown",this.handleKeyDown.bind(this)),document.addEventListener("keyup",this.handleKeyUp.bind(this))}handleKeyDown(e){"Tab"===e.key&&(e.preventDefault(),this.activatedCb())}handleKeyUp(e){"Tab"===e.key&&this.inactivatedCb()}}((()=>e.qs('[data-element-id="voice-input-button"]').click()),(async()=>{const t=e.qsaa('[data-element-id="pop-up-modal"] button');if(e.qsaa('[data-element-id="pop-up-modal"] .italic').find((e=>"start talking..."===e.innerText.toLowerCase().trim())))return void e.qsaa('[data-headlessui-state="open"]').forEach((e=>e.click()));await e.sleep(500),t.find((e=>"Finish"===e.innerText)).click();const n=await l();await e.waitFor((()=>n.value.trim().length)),(await e.waitForQs('[data-element-id="send-button"]')).click()}))})(),i||(e.bindHotkey("`",document,(async e=>{const t=["INPUT","TEXTAREA"].includes(document.activeElement?.tagName);"`"!==e.key||t||(await w()).click()})),e.bindHotkey("Escape",document,(async e=>{await f()})));const m=e.getQueryParam("mine_query");if(m){const t=await l();e.updateReactTypableFormValue(t,m),e.qs('[data-element-id="send-button"]').click()}const u=async e=>{const t=(()=>{const e=new Blob(["\n        self.onmessage = (e) => {\n          const logs = [];\n          self.console.log = (...args) => logs.push(args.join(' '));\n          try {\n            (new Function(e.data))();\n            self.postMessage(logs);\n          } catch (error) {\n            self.postMessage({ error: error.message });\n          }\n        };\n      "],{type:"application/javascript"}),t=URL.createObjectURL(e),n=new Worker(t);return{execute:e=>new Promise(((o,a)=>{n.onmessage=e=>{e.data.error?a(e.data.error):o(e.data.join("\n")),n.terminate(),URL.revokeObjectURL(t)},n.onerror=e=>{a(e.message),n.terminate(),URL.revokeObjectURL(t)},n.postMessage(e)})),terminate:()=>{n.terminate(),URL.revokeObjectURL(t)}}})();try{return await t.execute(e)}catch(e){throw e}finally{t.terminate()}};e.puic((()=>e.qsaa(`[data-element-id="response-block"]:has([d="${t}"]) code`)),(async e=>{const t=e.innerText.trim();if([".createElement","<script","<html"].some((e=>t.includes(e))))return;const n=t.split("\n");let o=n[n.length-1];if(o.startsWith("let ")||o.startsWith("const ")||o.match(/^[a-zA-Z0-9]+\s?=/)){const e=o.split("=")[0].split(" ").filter((e=>!!e.trim())).pop();o=`console.log(${e})`,n.push(o)}if(o.startsWith("console.log(")){const t="mine_code_output";let o;try{o=await u(n.join("\n"))}catch(a){if(a.toString().startsWith("ReferenceError:")||a.toString().split("\n")[0].trim().endsWith(" is not defined"))try{const a=[...e.closest('[data-element-id="response-block"]').querySelectorAll(`code:not(.${t})`)],s=[];for(const t of a){if(t===e)break;s.push(t.innerText)}const i=s.join("\n")+"\n\n"+n.join("\n");o=await u(i)}catch(e){}}if(o){const n=document.createElement("code");n.classList.add(t),n.style="font-size: 12.25px; display: block; font-style: italic; color: gray; border-top: 1px solid gray; margin-top: 10px; opacity: 0; transition: opacity 0.2s ease-in-out;",n.innerHTML=`${o}`,e.after(n),requestAnimationFrame((()=>{requestAnimationFrame((()=>{n.style.opacity=1}))}))}else console.log("no ans",n.join("\n"))}})),i||k(),window.addEventListener("beforeunload",(async e=>{await f()}))},k=async()=>{const t=document.createElement("div");t.innerHTML='\n    <style>\n      .mine_notes:not(:placeholder-shown) {\n        right: -2px;\n        height: calc(100vh - 60px - 100px);\n      }\n      .mine_notes:hover {\n        opacity: 1;\n      }\n      .mine_notes:focus {\n        opacity: 1;\n        right: -2px;\n        outline: none !important;\n        box-shadow: none !important;\n      }\n      .mine_notes {\n        transition: all 0.2s ease;\n        cursor: pointer;\n        opacity: 0.2;\n        line-height: 1.1em;\n        padding: 7px;\n        position: fixed;\n        right: -12.9%;\n        top: 60px;\n        background: rgb(39, 39, 42);\n        color: white;\n        width: 15%;\n        border-radius: 10px 0 0 10px;\n        border-width: 2px;\n        height: 36px;\n        resize: none;\n      }\n    </style>\n    <textarea class="mine_notes" placeholder="ðŸ“ Notes..." title="[M] Notepad"></textarea>\n    ',document.body.append(t);const n=t.querySelector(".mine_notes"),o="mine_notes",a=()=>{n.value=localStorage.getItem(o)||""};a();const s=e.debounce((()=>{localStorage.setItem(o,n.value),requestAnimationFrame((()=>n.style.borderColor="green"))}),500);n.addEventListener("input",(()=>{n.style.borderColor="orange",s()})),window.addEventListener("storage",(e=>{e.key===o&&a()}))};i?await x():((async()=>{document.body.style.opacity=.1,await(async()=>{const t=e.isi("div > div:has(> #navbar) {display:none;}".trim());(await w()).click(),document.body.style.display="block",setTimeout(t,300)})(),"true"===e.getQueryParam("mine_wipe")&&await(async()=>{const t=await l(),n=t.value;e.updateReactTypableFormValue(t,""),document.dispatchEvent(new KeyboardEvent("keydown",{key:"j",code:"KeyJ",metaKey:!0,altKey:!0,bubbles:!0,cancelable:!0})),e.updateReactTypableFormValue(t,n)})(),document.body.style.opacity=1})().then(x),window.addEventListener("resize",b)),m('[data-element-id="send-button"]',(()=>{((t=0)=>{const n=e.qs("html");return n.scrollHeight-n.scrollTop<=n.clientHeight+t+1})(500)||(h=!1,setTimeout(y,3e3))})),i&&(async()=>{m('button:has([d="M878.3 392.1L631.9 145.7c-6.5-6.5-15-9.7-23.5-9.7s-17 3.2-23.5 9.7L423.8 306.9c-12.2-1.4-24.5-2-36.8-2-73.2 0-146.4 24.1-206.5 72.3a33.23 33.23 0 0 0-2.7 49.4l181.7 181.7-215.4 215.2a15.8 15.8 0 0 0-4.6 9.8l-3.4 37.2c-.9 9.4 6.6 17.4 15.9 17.4.5 0 1 0 1.5-.1l37.2-3.4c3.7-.3 7.2-2 9.8-4.6l215.4-215.4 181.7 181.7c6.5 6.5 15 9.7 23.5 9.7 9.7 0 19.3-4.2 25.9-12.4 56.3-70.3 79.7-158.3 70.2-243.4l161.1-161.1c12.9-12.8 12.9-33.8 0-46.8zM666.2 549.3l-24.5 24.5 3.8 34.4a259.92 259.92 0 0 1-30.4 153.9L262 408.8c12.9-7.1 26.3-13.1 40.3-17.9 27.2-9.4 55.7-14.1 84.7-14.1 9.6 0 19.3.5 28.9 1.6l34.4 3.8 24.5-24.5L608.5 224 800 415.5 666.2 549.3z"])',(async t=>{(await e.waitFor((()=>{const t=e.qsaa('[data-element-id="pop-up-modal"] [data-element-id="response-block"]');return t.length?t:null}))).forEach((t=>t.addEventListener("touchend",(async()=>{const n=t.innerText,o=e.qsaa('[data-element-id="response-block"]').filter((e=>e!==t)).find((e=>e.innerText===n));o&&(await e.waitFor((()=>!e.qs('[data-element-id="pop-up-modal"]'))),await e.sleep(1e3),o.scrollIntoView({behavior:"smooth"}))}))))}))})();const E="mine_quote",T="mine_quote_src",L=(t,n=!1)=>{const o=t.closest('[data-element-id="user-message"]'),a=e.qsaa('[data-element-id="ai-response"], [data-element-id="user-message"]'),s=Array.from(a).filter((e=>e.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_FOLLOWING)),i=t.innerText.substring(1).trim(),r=s.reverse().find((e=>e.innerText.includes(i)));if(!r)return;const c=((e,t)=>{if(!e||!t)return null;let n=null;const o=e=>{if(e.nodeType===Node.TEXT_NODE)return(e=>{const o=e.textContent.indexOf(t);if(o>=0){if(e.parentElement&&"MARK"===e.parentElement.tagName&&e.parentElement.textContent===t)return n=e.parentElement,!0;const a=document.createRange();a.setStart(e,o),a.setEnd(e,o+t.length);const s=(()=>{const e=document.createElement("mark");return e.className=T,e})();return a.surroundContents(s),n=s,!0}return!1})(e);if(e.nodeType===Node.ELEMENT_NODE){if("MARK"===e.tagName&&e.textContent===t)return n=e,!0;if(e.childNodes)for(let t=0;t<e.childNodes.length;t++)if(o(e.childNodes[t]))return!0}return!1};return o(e),n})(r,i);n&&(c??r).scrollIntoView({behavior:"smooth"})},C=async()=>{await e.waitForQs('[data-element-id="user-message"]',{recheckIntervalMs:100,timeoutMs:1/0}).catch((()=>null)).then((t=>{if(!t)return;const n=e.qsaa('[data-element-id="user-message"] div'),o=e=>{(e=>{const t=e.innerHTML.split("\n").map((e=>{if(e.trim().startsWith("&gt; ")||e.trim().startsWith("> ")){const t=e.replace(/^>\s/,"&gt; ").replace(/&gt;\s/,"&gt; ");return`<span class="${E}">${t}</span>`}return e}));e.innerHTML=t.join("\n"),[...e.querySelectorAll(`.${E}`)].forEach((e=>L(e)))})(e),(e=>{const t=e.innerHTML.split("\n").map((e=>'"""'===e.trim()?`<span class="mine_triple_quote">${e}</span>`:e));e.innerHTML=t.join("\n")})(e)};e.pui(n,o,"enrich"),o(n.pop())}))};(async()=>{e.isi(`\n.${E} {\n  font-style: italic;\n  color: gray;\n  cursor: pointer;\n}\n.mine_triple_quote {\n  color: gray;\n}\n\n.${T} {\n  background: mediumslateblue;\n  border-radius: 3px;\n  color: black !important;\n  cursor: pointer;\n}\n`),m(`.${E}`,(async e=>L(e,!0))),m(`.${T}`,(async t=>window.getSelection().isCollapsed&&e.qsaa(".mine_quote").find((e=>e.innerText===`> ${t.innerText}`))?.scrollIntoView({behavior:"smooth"}))),m('[data-element-id="send-button"]',(async()=>{await e.sleep(100),C()}))})(),setTimeout(C,1e3),(()=>{const t="https://i.ibb.co/hLZVQdK/image-15-1.png",n=t=>{Array.from(e.qsaa("link[rel*='icon']")).forEach((e=>e.remove()));const n=document.createElement("link");n.type="image/x-icon",n.rel="shortcut icon",n.href=t,document.head.appendChild(n),document.body.appendChild(n.cloneNode())};for(let e=0;e<5;e++)setTimeout((()=>n(t)),1e3*e);let o;const a=()=>document.title.startsWith("(*) ");document.addEventListener("visibilitychange",(()=>{document.hidden?(n(t),new Promise((e=>{let t=0;o=setInterval((()=>{(a()||60==++t)&&(clearInterval(o),e(a()))}),1e3)})).then((e=>e?n("https://i.ibb.co/XJnJv5p/image-18.png"):null))):(o&&(clearInterval(o),o=null),n(t))}))})(),i&&(()=>{const t=(e,t,n={})=>{const{maxTimeBetweenTaps:o=300,maxDistanceBetweenTaps:a=20,mustBeExactElement:s=!1}=n;let i=0,r=0,c=0;document.body.addEventListener("touchend",(n=>{const l=s?n.target.matches(e):n.target.closest(e);if(!l)return;const d=n.changedTouches[0],p=(new Date).getTime(),m=d.clientX,u=d.clientY,h=p-i,y=Math.hypot(m-r,u-c);h>0&&h<o&&y<a&&(n.preventDefault(),t(l,n)),i=p,r=m,c=u}),!1)},n='div:has(>[data-element-id="more-actions-menu-button"])';e.hideQs(n),t('[data-element-id="response-block"]',(e=>{const t=e.querySelector(n);"flex"===window.getComputedStyle(t).getPropertyValue("display")?t.style.removeProperty("display"):t.style.setProperty("display","flex","important")}));let o,a,s=!1;const i=async()=>{const t=['[data-element-id="upload-document-button"]','[data-element-id="voice-input-button"]',".hide-when-print.sticky","#elements-in-action-buttons"],n=`\n  ${t.join(",\n")} {\n    opacity: 1;\n    transition: opacity 200ms ease-in-out;\n  }\n  ${t.map((e=>`.fullscreen-active ${e}`)).join(",\n")} {\n    opacity: 0;\n    pointer-events: none;\n  }\n  ${t.filter((e=>![".hide-when-print.sticky","#elements-in-action-buttons"].includes(e))).map((e=>`.fullscreen-hide ${e}`)).join(",\n")} {\n    display: none !important;\n  }\n      `;o||(o=e.isi(n));const i=await l();s?(i.style.maxWidth=a,await e.sleep(200),document.body.classList.remove("fullscreen-hide"),document,document.body.classList.remove("fullscreen-active")):(a=getComputedStyle(i).width,i.style.maxWidth=a,i.style.transition="max-width 200ms ease",document.body.classList.add("fullscreen-active"),setTimeout((()=>document.body.classList.add("fullscreen-hide")),200),setTimeout((()=>i.style.maxWidth="1000px"),300)),s=!s};t('body, [data-element-id="chat-space-background"]',i,{mustBeExactElement:!0}),t('[data-element-id="chat-space-middle-part"],div:has(>[data-element-id="chat-space-end-part"])',((e,t)=>{t.target.closest('[data-element-id="user-message"]')||t.target.closest('[data-element-id="ai-response"]')||i()})),i()})(),i&&(document.querySelectorAll('meta[name^="apple-"]').forEach((e=>e.remove())),[{name:"apple-mobile-web-app-capable",content:"yes"},{name:"apple-mobile-web-app-status-bar-style",content:"black-translucent"}].forEach((({name:e,content:t})=>{const n=document.createElement("meta");n.name=e,n.content=t,document.head.appendChild(n)})),document.addEventListener("visibilitychange",(()=>{if(!document.hidden){const e=document.querySelector('meta[name="apple-mobile-web-app-status-bar-style"]');e&&(e.content="black-translucent")}}))),await(async()=>{const t=e.dim(document.body),n=await d("remoteChatJsonBinBinId"),o=await d("remoteChatJsonBinXMasterKey");if(!n||!o)return null;const a=await fetch(`https://api.jsonbin.io/v3/b/${n}`,{headers:{"Content-Type":"application/json","X-MASTER-KEY":o}}).then((e=>e.json())).then((e=>e.record)),s=e=>atob(e),i=s(a.query),r=s(a.context);console.log(submitMessage(i,r));let c=i;r&&(c+=`\n\nUse the following context:\n\`\`\`\n${r}\n\`\`\``),t()})()})();